#+TITLE: 内存屏障

* 概述
在学jvm虚拟机的时候，曾学过这个内容，但是过了很长时间明显已经遗忘。其核心概念其实很简单，编译器一般会对代码进行优化，你写的代码顺序在编译器优化后，其顺序可能会改变。但是对于某些读写操作，如果不进行限制，其乱序就会导致一些问题。内存屏障(memory barrier)就是保证其屏障前的指令一定先于屏障后的指令运行。
一般来说，写操作之后，读操作之前可以插入内存屏障.大部分内存屏障提供了以下三种：
- 完全内存屏障：保障早于屏障的内存读写操作的结果提交到内存之后，再执行晚于屏障的读写操作
- 内存读屏障：仅确保了内存读操作
- 内存写屏障：仅保障了内存写操作
